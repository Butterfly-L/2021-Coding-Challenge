const container=document.getElementById("container"),file=document.getElementById("fileupload"),canvas=document.getElementById("canvas1");canvas.width=window.innerWidth,canvas.height=window.innerHeight;const ctx=canvas.getContext("2d");let audioSource,analyser;function drawVisualiser(e,t,n,a,c){for(let i=0;i<e;i++){const e=i*(a=c[i])/10,o=4*i,r=a/10;ctx.fillStyle="rgb("+e+","+o+","+r+")",ctx.fillRect(canvas.width/2-t,canvas.height-a,n,a),t+=n}for(let i=0;i<e;i++){const e=i*(a=c[i])/10,o=20*i,r=a/10;ctx.fillStyle="rgb("+e+","+o+","+r+")",ctx.fillRect(t,canvas.height-a,n,a),t+=n}}ctx.save(),ctx.font="32px 'Ubuntu', sans-serif",ctx.fillStyle="white",ctx.fillText("點擊畫面播放音樂",30,100),ctx.fillText("或上傳新的檔案",30,150),ctx.translate(canvas.width/2,canvas.width/2),ctx.restore(),container.addEventListener("click",(function(){const e=document.getElementById("audio1");e.src="https://cdn.pixabay.com/download/audio/2021/05/01/audio_f88aa31493.mp3?filename=tech-house-loop-01-4230.mp3";const t=new AudioContext;e.play(),audioSource=t.createMediaElementSource(e),analyser=t.createAnalyser(),audioSource.connect(analyser),analyser.connect(t.destination),analyser.fftSize=64;const n=analyser.frequencyBinCount,a=new Uint8Array(n),c=canvas.width/2/n;let i;!function e(){i=0,ctx.clearRect(0,0,canvas.width,canvas.height),analyser.getByteFrequencyData(a),drawVisualiser(n,0,c,undefined,a),requestAnimationFrame(e)}()})),file.addEventListener("change",(function(){const e=this.files,t=document.getElementById("audio1");t.src=URL.createObjectURL(e[0]),t.load(),t.play(),audioSource=audioContext.createMediaElementSource(t),analyser=audioContext.createAnalyser(),audioSource.connect(analyser),analyser.connect(audioContext.destination),analyser.fftSize=64;const n=analyser.frequencyBinCount,a=new Uint8Array(n),c=canvas.width/n;let i;!function e(){i=0,ctx.clearRect(0,0,canvas.width,canvas.height),analyser.getByteFrequencyData(a),drawVisualiser(n,0,c,undefined,a),requestAnimationFrame(e)}()}));
//# sourceMappingURL=canvasSound.min.js.map