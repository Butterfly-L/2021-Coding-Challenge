{"version":3,"sources":["canvasGame.js"],"names":["canvas","document","getElementById","ctx","getContext","score","scoreText","highscore","highscoreText","player","gravity","gameSpeed","obstacles","keys","obstacleType","text","color","initialSpawnTimer","spawnTimer","createCanvas","width","height","font","Player","resetGame","Text","requestAnimationFrame","Update","createObstacle","size","RandomIntInRange","typeNum","type","obstacle","Obstacle","y","originalHeight","push","min","max","Math","round","random","clearRect","i","length","o","x","w","splice","h","setScore","Animate","t","Draw","localStorage","getItem","window","setItem","addEventListener","evt","code"],"mappings":"AAAA,MAAMA,OAASC,SAASC,eAAe,QACjCC,IAAMH,OAAOI,WAAW,MAG9B,IAAIC,MACAC,UACAC,UACAC,cACAC,OACAC,QAEAC,UADAC,UAAY,GAEZC,KAAO,GACPC,aAAe,CAAC,CAACC,KAAM,KAAMC,MAAO,WAAW,CAACD,KAAM,KAAMC,MAAO,WAAW,CAACD,KAAM,KAAMC,MAAO,YAClGC,kBAAoB,IACpBC,WAAaD,kBAWjB,SAASE,eACPnB,OAAOoB,MAAQ,IACfpB,OAAOqB,OAAS,IAChBlB,IAAImB,KAAO,kBAEXb,OAAS,IAAIc,OAAO,GAAI,EAAG,GAAI,KAE/BC,YACAlB,UAAY,IAAImB,KAAK,UAAYpB,MAAO,GAAI,GAAI,OAAQ,UAAW,MACnEG,cAAgB,IAAIiB,KAAK,cAAgBlB,UAAWP,OAAOoB,MAAQ,GAAI,GAAI,QAAS,UAAW,MAG/FM,sBAAsBC,QAIxB,SAASC,iBAEP,IAAIC,EAAOC,iBAAiB,GAAI,IAC5BC,EAAUD,iBAAiB,EAAG,GAC9BE,EAAOF,iBAAiB,EAAG,GAC3BG,EAAW,IAAIC,SAASlC,OAAOoB,MAAQS,EAAM7B,OAAOqB,OAASQ,EAAMA,EAAMA,EAAMf,aAAaiB,IAGpF,GAARC,IACFC,EAASE,GAAK1B,OAAO2B,eAAiB,IAExCxB,UAAUyB,KAAKJ,GAIjB,SAASH,iBAAkBQ,EAAKC,GAC9B,OAAOC,KAAKC,MAAMD,KAAKE,UAAYH,EAAMD,GAAOA,GAKlD,SAASX,SACPxB,IAAIwC,UAAU,EAAG,EAAG3C,OAAOoB,MAAOpB,OAAOqB,QAGzCH,aACIA,YAAc,IAChBU,iBACAV,WAAaD,kBAAgC,EAAZN,UAC7BO,WAAa,KACfA,WAAa,KAKjB,IAAK,IAAI0B,EAAI,EAAGA,EAAIhC,UAAUiC,OAAQD,IAAK,CACzC,IAAIE,EAAIlC,UAAUgC,GAGdE,EAAEC,EAAID,EAAEE,EAAI,GACdpC,UAAUqC,OAAOL,EAAG,GAGtBE,EAAEnB,SAIAlB,OAAOsC,EAAID,EAAEC,EAAID,EAAEE,GACnBvC,OAAOsC,EAAItC,OAAOuC,EAAIF,EAAEC,GACxBtC,OAAO0B,EAAIW,EAAEX,EAAIW,EAAEI,GACnBzC,OAAO0B,EAAI1B,OAAOyC,EAAIJ,EAAEX,GAEtBX,YAKN2B,WACA1C,OAAO2C,UACPzC,WAAa,KACbe,sBAAsBC,QAGxB,SAASwB,WACP9C,QACAC,UAAU+C,EAAI,SAAWhD,MACzBC,UAAUgD,OAENjD,MAAQE,YACVA,UAAYF,MACZG,cAAc6C,EAAI,cAAgB9C,WAEpCC,cAAc8C,OAGhB,SAAS9B,YACPZ,UAAY,GACZP,MAAQ,EACRE,UAAYgD,aAAaC,QAAQ,aAAeD,aAAaC,QAAQ,aAAe,EACpFtC,WAAaD,kBACbN,UAAY,EACZD,QAAU,EACV+C,OAAOF,aAAaG,QAAQ,YAAanD,WA1G3CN,SAAS0D,iBAAiB,WAAW,SAAUC,GAC7C/C,KAAK+C,EAAIC,OAAQ,KAEnB5D,SAAS0D,iBAAiB,SAAS,SAAUC,GAC3C/C,KAAK+C,EAAIC,OAAQ,KA0GnB1C","file":"canvasGame.min.js","sourcesContent":["const canvas = document.getElementById('game');\nconst ctx = canvas.getContext('2d'); \n\n// Variables\nlet score;\nlet scoreText;\nlet highscore;\nlet highscoreText;\nlet player;\nlet gravity;\nlet obstacles = [];\nlet gameSpeed;\nlet keys = {};\nlet obstacleType = [{text: '加班', color: '#4530ff'},{text: '渣男', color: '#009c27'},{text: '經痛', color: '#ff3e30'}];\nlet initialSpawnTimer = 200; //數字越小越快歸零就會越多敵人\nlet spawnTimer = initialSpawnTimer;\n\n// Event Listeners\ndocument.addEventListener('keydown', function (evt) {\n  keys[evt.code] = true;\n});\ndocument.addEventListener('keyup', function (evt) {\n  keys[evt.code] = false;\n});\n\n//遊戲最開始的繪製\nfunction createCanvas () {\n  canvas.width = 648;\n  canvas.height = 572;\n  ctx.font = \"20px sans-serif\";\n  //做玩家\n  player = new Player(25, 0, 80, 180);\n  \n  resetGame();\n  scoreText = new Text(\"Score: \" + score, 25, 25, \"left\", \"#ffffff\", \"20\");\n  highscoreText = new Text(\"Highscore: \" + highscore, canvas.width - 25, 25, \"right\", \"#ffffff\", \"20\");\n\n  //呼叫Update\n  requestAnimationFrame(Update);\n}\n\n//做障礙物\nfunction createObstacle () {\n  //一次只做一個\n  let size = RandomIntInRange(40, 70);\n  let typeNum = RandomIntInRange(0, 2);\n  let type = RandomIntInRange(0, 1);\n  let obstacle = new Obstacle(canvas.width + size, canvas.height - size, size, size, obstacleType[typeNum]);\n\n  //做高高的障礙物\n  if (type == 1) {\n    obstacle.y -= player.originalHeight - 10;\n  }\n  obstacles.push(obstacle);\n}\n\n\nfunction RandomIntInRange (min, max) {\n  return Math.round(Math.random() * (max - min) + min);\n}\n\n\n//遊戲進行時Update會一直呼叫自己\nfunction Update () {\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n\n  //製作敵人\n  spawnTimer--; //控制敵人速度\n  if (spawnTimer <= 0) {\n    createObstacle(); \n    spawnTimer = initialSpawnTimer - gameSpeed * 8; //數字越來越小=製作敵人速度越來越快\n    if (spawnTimer < 60) {\n      spawnTimer = 60; //但最快還是有60\n    }\n  }\n  \n  //Spawn enimies\n  for (let i = 0; i < obstacles.length; i++) {\n    let o = obstacles[i];\n\n    //移除滑出視窗的\n    if (o.x + o.w < 0) {\n      obstacles.splice(i, 1); \n    }\n\n    o.Update(); //放置敵人位置=敵人移動的速度\n\n    //撞到障礙物\n    if (\n      player.x < o.x + o.w &&\n      player.x + player.w > o.x &&\n      player.y < o.y + o.h &&\n      player.y + player.h > o.y\n      ) {\n        resetGame();\n    }\n  }\n  \n  \n  setScore(); //設置分數\n  player.Animate(); //讓player動起來\n  gameSpeed += 0.003; //加快速度\n  requestAnimationFrame(Update);\n}\n\nfunction setScore(){\n  score++;\n  scoreText.t = \"Score:\" + score;\n  scoreText.Draw();\n\n  if (score > highscore) {\n    highscore = score;\n    highscoreText.t = \"Highscore: \" + highscore;\n  }\n  highscoreText.Draw();\n}\n\nfunction resetGame(){\n  obstacles = [];\n  score = 0;\n  highscore = localStorage.getItem('highscore') ? localStorage.getItem('highscore') : 0;\n  spawnTimer = initialSpawnTimer;\n  gameSpeed = 3;\n  gravity = 1;  \n  window.localStorage.setItem('highscore', highscore);\n}\n\n//最開始呼叫\ncreateCanvas();\n\n"]}